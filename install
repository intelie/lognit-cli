#!/bin/sh
echo Installing Lognit command-line interface...
file=$(curl -s "https://api.github.com/repos/intelie/lognit-cli/downloads" | grep "https://github.com/downloads/intelie/lognit-cli/lognit-cli-" | sed 's/    "html_url": "//' | sed 's/",//' | sort | tail -n 1)
echo $file
curl -L $file > /tmp/nit
mv /tmp/nit /usr/bin/nit
chmod a+x /usr/bin/nit

echo "
_nit() 
{
    COMPREPLY=()
    local cur=\"\${COMP_WORDS[COMP_CWORD]}\"

    if [[ \${cur} == ?* ]] ; then
        COMPREPLY=( \$(nit -c \${cur} ) )
        return 0
    fi
}
complete -F _nit nit
" > /tmp/_nit
if [ -d /etc/bash_completion.d ]; then
    echo "Installing bash completion (linux)"
    cp /tmp/_nit /etc/bash_completion.d/nit
fi
if [ -d /usr/local/etc/bash_completion.d ]; then
    echo "Installing bash completion (mac)"
    cp /tmp/_nit /usr/local/etc/bash_completion.d/nit
fi


